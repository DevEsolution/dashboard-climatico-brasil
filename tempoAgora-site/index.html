<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tempo Agora | Monitoramento Climático Brasil</title>
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        agro: {
                            50: '#f0fdf4',
                            100: '#dcfce7',
                            400: '#86efac',
                            600: '#16a34a',
                            800: '#166534',
                        },
                        sky: {
                            50: '#f0f9ff',
                            300: '#bae6fd',
                            400: '#7dd3fc',
                            600: '#0284c7',
                            800: '#075985',
                            900: '#0c4a6e',
                        }
                    }
                }
            }
        }
    </script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body class="font-sans bg-slate-800 main-background">

    <!-- Navbar -->
    <nav class="bg-slate-900/50 backdrop-blur-lg shadow-lg border-b border-white/10">
        <div class="container mx-auto px-4 py-3 flex items-center gap-3">
            <i class="fa-solid fa-cloud-sun-rain text-3xl text-sky-400"></i>
            <h1 class="text-2xl font-bold text-white">TempoAgora</h1>
        </div>
    </nav>

    <!-- Header & Search -->
    <header class="glass-header p-8 text-white">
        <div class="container mx-auto">
            <h2 class="text-3xl font-bold mb-4">Consulte o clima em tempo real</h2>
            
            <div class="relative">
                <input type="text" id="search-input" 
                    placeholder="Buscar cidade ou estado (ex: Sorriso, SP)..." 
                    class="w-full p-3 rounded-lg bg-slate-800/60 text-white placeholder-slate-400 border border-slate-600 focus:outline-none focus:ring-2 focus:ring-sky-400 transition"
                    aria-label="Buscar por cidade ou estado">
                <i class="fa-solid fa-magnifying-glass absolute right-4 top-1/2 transform -translate-y-1/2 text-slate-400"></i>
            </div>
            <!-- Feedback para busca -->
            <p id="search-feedback" class="text-xs text-yellow-400 mt-2 h-4"></p>
        </div>
    </header>

    <!-- NOVO: Container para Resultados da Busca -->
    <div id="search-results-container" class="hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">
        <div class="flex justify-between items-center mb-6">
            <h3 id="search-results-title" class="text-lg font-bold text-white border-l-4 border-sky-400 pl-3">Resultados da Busca</h3>
            <button id="close-search-btn" class="text-sm text-slate-300 hover:text-sky-400 font-medium" aria-label="Fechar resultados da busca">
                <i class="fa-solid fa-times mr-1"></i> Fechar Busca
            </button>
        </div>
        <div id="search-results-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            <!-- Resultados da busca serão inseridos aqui -->
        </div>
        
        <!-- Fallback Sem Resultados para a Busca -->
        <div id="search-empty-state" class="hidden text-center py-12">
            <div class="inline-block p-4 rounded-full bg-slate-700 mb-3">
                <i class="fa-solid fa-wind text-slate-400 text-2xl"></i>
            </div>
            <h3 class="text-lg font-medium text-slate-300">Nenhuma cidade encontrada</h3>
            <p class="text-slate-400">Tente outro termo de busca.</p>
        </div>
    </div>

    <!-- CONTEÚDO PRINCIPAL -->
    <main id="main-dashboard-content" class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">
        <div id="main-content-wrapper">
            <!-- NOVO: Boletim Gerado Dinamicamente -->
            <section id="bulletin-section" class="mb-10 hidden">
                <div class="glass-section p-6 flex flex-col md:flex-row gap-6 items-start">
                    <div class="flex-shrink-0 bg-sky-900/50 p-3 rounded-full">
                        <i class="fa-solid fa-tower-broadcast text-sky-300 text-2xl"></i>
                    </div>
                    <div class="flex-grow">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="text-lg font-bold text-white">Boletim Nacional Agora</h3>
                            <div id="bulletin-timer-info" class="flex items-center gap-3 text-xs text-slate-400">
                                <div class="text-right">
                                    <p>Atualizado às: <span id="last-update-time" class="font-semibold">--:--</span></p>
                                    <p>Próxima em: <span id="next-update-countdown" class="font-bold text-sky-400">--:--</span></p>
                                </div>
                            </div>
                        </div>
                        <div id="forecast-brasil-container" class="text-slate-300 leading-relaxed pb-4">
                            Carregando análise meteorológica...
                        </div>
                        <div class="w-full bg-slate-700/50 rounded-full h-1.5 mt-2 overflow-hidden">
                            <div id="bulletin-progress-bar" class="bg-sky-400 h-1.5 rounded-full transition-all duration-1000 ease-linear"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Radar de Chuva -->
            <section class="mb-10">
                <h3 class="text-lg font-bold text-white mb-4 border-l-4 border-agro-400 pl-3">Mapa Interativo do Clima</h3>
                <div id="radar-container" class="w-full h-[400px] rounded-xl overflow-hidden glass-section">
                    <!-- Radar carrega aqui -->
                </div>
            </section>

            <!-- SLOT DE ANÚNCIO LEADERBOARD -->
            <div class="ad-container my-10">
                <div class="ad-leaderboard glass-section flex items-center justify-center">
                    <div class="text-center text-slate-400">
                        <p class="font-bold text-lg">Publicidade</p>
                        <p class="text-sm">(Espaço para Banner 728x90)</p>
                    </div>
                </div>
            </div>

            <!-- NOVA SEÇÃO: Carrossel de Emergências -->
            <section class="mb-10">
                <h3 class="text-lg font-bold text-white mb-4 border-l-4 border-red-500 pl-3">Serviços de Emergência</h3>
                <div class="relative">
                    <div id="emergency-carousel" class="flex overflow-x-auto snap-x-mandatory scroll-smooth gap-6 pb-4">
                        <!-- Slides do carrossel serão inseridos aqui via JS -->
                    </div>
                    <button id="prev-slide" class="carousel-arrow left-0" aria-label="Slide anterior"><i class="fa-solid fa-chevron-left"></i></button>
                    <button id="next-slide" class="carousel-arrow right-0" aria-label="Próximo slide"><i class="fa-solid fa-chevron-right"></i></button>
                </div>
            </section>

            <!-- Filtros e Contagem -->
            <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                <div id="filter-container" class="flex flex-nowrap space-x-2 pb-2 overflow-x-auto">
                    <button class="filter-btn active" data-filter="all">Todas</button>
                    <button class="filter-btn" data-filter="capital">Capitais</button>
                    <button class="filter-btn" data-filter="agricola">
                        <i class="fa-solid fa-tractor mr-1 text-agro-400"></i> Polos Agrícolas
                    </button>
                    <button class="filter-btn" data-filter="pinned">
                        <i class="fa-solid fa-star mr-1 text-yellow-400"></i> Favoritas
                    </button>
                </div>
                <div class="flex items-center gap-2 text-sm text-slate-400">
                    <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                    Atualização em tempo real
                </div>
            </div>

            <!-- Grid de Cards -->
            <div id="cards-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <div class="col-span-full flex flex-col items-center justify-center py-12 text-slate-400">
                    <i class="fa-solid fa-circle-notch fa-spin text-3xl mb-2"></i>
                    <p>Conectando à API Open-Meteo...</p>
                </div>
            </div>
            
            <!-- Fallback Sem Resultados -->
            <div id="empty-state" class="hidden text-center py-12">
                <div class="inline-block p-4 rounded-full bg-slate-700 mb-3">
                    <i class="fa-solid fa-wind text-slate-400 text-2xl"></i>
                </div>
                <h3 class="text-lg font-medium text-slate-300">Nenhuma cidade encontrada</h3>
                <p class="text-slate-400">Tente outro termo de busca.</p>
            </div>
        </div>
    </main>

    <!-- Modal de Pânico -->
    <div id="panic-modal" class="fixed hidden inset-0 z-[60] bg-black/50 items-center justify-center p-4">
        <div class="glass-section p-8 max-w-md w-full border-t-4 border-red-500 relative">
            <h2 class="text-2xl font-bold mb-2 text-white">Alerta de Pânico</h2>
            <p class="text-slate-300 mb-4">Compartilhe sua localização com um contato de emergência:</p>

            <div class="mb-4">
                <label for="phone-number" class="block text-slate-300 text-sm font-bold mb-2">WhatsApp do Contato (com DDD):</label>
                <input type="tel" id="phone-number" placeholder="Ex: 11999999999" class="w-full p-3 rounded-lg bg-slate-800/60 text-white placeholder-slate-400 border border-slate-600 focus:outline-none focus:ring-2 focus:ring-red-500 transition">
            </div>

            <div class="flex justify-end gap-3">
                <button onclick="closePanicModal()" class="modal-btn-secondary" aria-label="Cancelar ação de pânico">Cancelar</button>
                <button onclick="sharePanicInfo('whatsapp')" class="modal-btn-primary bg-green-500/80 hover:bg-green-600" aria-label="Enviar localização por WhatsApp">
                    <i class="fa-brands fa-whatsapp"></i> Enviar Localização
                </button>
            </div>
        </div>
    </div>

    <!-- Botão Flutuante Pânico -->
    <button onclick="openPanicModal()" class="fixed bottom-6 right-6 bg-red-600 hover:bg-red-700 text-white rounded-full p-4 shadow-lg transition-transform hover:scale-105 z-50 group flex items-center gap-2 pr-6" aria-label="Abrir modal de pânico SOS">
        <i class="fa-solid fa-triangle-exclamation text-xl"></i>
        <span class="font-bold">SOS</span>
    </button>

    <footer class="bg-slate-900/50 backdrop-blur-lg border-t border-white/10 mt-auto">
        <div class="max-w-7xl mx-auto px-4 py-6 text-center md:text-left md:flex md:justify-between md:items-center">
            <p class="text-sm text-slate-400 mb-2 md:mb-0">
                © 2025 TempoAgora. Dados fornecidos por <a href="https://open-meteo.com/" target="_blank" class="underline hover:text-sky-400">Open-Meteo API</a>.
            </p>
            <p class="text-sm text-slate-400">
                Desenvolvido por <strong>Valter Moraes</strong> | 
                <a href="mailto:moraesvalter26@gmail.com" class="underline hover:text-sky-400"><i class="fa-solid fa-envelope"></i> E-mail</a> | 
                <a href="https://wa.me/554789284337" target="_blank" class="underline hover:text-sky-400"><i class="fa-brands fa-whatsapp"></i> WhatsApp</a>
            </p>
        </div>
    </footer>

    <script src="script.js"></script>
</body>
</html>
